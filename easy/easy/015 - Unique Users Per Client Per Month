SELECT 
    client_id,
    EXTRACT(MONTH FROM time_id) AS month,
    COUNT(DISTINCT user_id) AS no_of_user
FROM 
    fact_events
GROUP BY 
    client_id,
    EXTRACT(MONTH FROM time_id)
ORDER BY 
    client_id, month;


---




-- Step 1: Select all unique customers who made purchases
SELECT DISTINCT p.customer_id
FROM purchases p

-- Step 2: Exclude those who have made any returns
WHERE p.customer_id NOT IN (
    SELECT DISTINCT r.customer_id
    FROM returns r
);




